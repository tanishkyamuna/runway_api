{"version":3,"file":"Analytics-JehAgstq.js","sources":["../../src/components/admin/Analytics.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport { TrendingUp, Users, Video, Package, Clock, Star, ArrowUp, ArrowDown } from 'lucide-react';\nimport toast from 'react-hot-toast';\n\nconst Analytics = () => {\n  const [timeframe, setTimeframe] = useState('7d');\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState({\n    totalUsers: 0,\n    totalVideos: 0,\n    averageProcessingTime: 0,\n    totalRevenue: 0,\n    recentActivity: []\n  });\n\n  useEffect(() => {\n    fetchAnalytics();\n  }, [timeframe]);\n\n  const fetchAnalytics = async () => {\n    try {\n      setLoading(true);\n\n      // Get total users\n      const { count: userCount, error: userError } = await supabase\n        .from('profiles')\n        .select('*', { count: 'exact', head: true });\n\n      if (userError) throw userError;\n\n      // Get total videos\n      const { count: videoCount, error: videoError } = await supabase\n        .from('videos')\n        .select('*', { count: 'exact', head: true });\n\n      if (videoError) throw videoError;\n\n      // Get average processing time\n      const { data: videos, error: processingError } = await supabase\n        .from('videos')\n        .select('created_at, updated_at')\n        .eq('status', 'completed');\n\n      if (processingError) throw processingError;\n\n      const avgTime = videos?.reduce((acc, video) => {\n        const start = new Date(video.created_at);\n        const end = new Date(video.updated_at);\n        return acc + (end - start);\n      }, 0) / (videos?.length || 1);\n\n      // Get total revenue\n      const { data: transactions, error: revenueError } = await supabase\n        .from('payment_transactions')\n        .select('amount')\n        .eq('status', 'completed');\n\n      if (revenueError) throw revenueError;\n\n      const totalRevenue = transactions?.reduce((acc, tx) => acc + tx.amount, 0) || 0;\n\n      setStats({\n        totalUsers: userCount || 0,\n        totalVideos: videoCount || 0,\n        averageProcessingTime: avgTime || 0,\n        totalRevenue: totalRevenue,\n        recentActivity: []\n      });\n\n    } catch (error) {\n      console.error('Error fetching analytics:', error);\n      toast.error('Failed to load analytics data');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDuration = (ms) => {\n    const minutes = Math.floor(ms / 60000);\n    const seconds = ((ms % 60000) / 1000).toFixed(0);\n    return `${minutes}:${seconds.padStart(2, '0')}`;\n  };\n\n  const formatMoney = (amount) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD'\n    }).format(amount);\n  };\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"flex justify-between items-center mb-8\">\n        <h1 className=\"text-3xl font-bold\">Analytics</h1>\n        <div className=\"flex gap-2\">\n          {['7d', '30d', '90d'].map((t) => (\n            <button\n              key={t}\n              onClick={() => setTimeframe(t)}\n              className={`px-4 py-2 rounded-lg transition-colors ${\n                timeframe === t\n                  ? 'bg-blue-600 text-white'\n                  : 'bg-white text-gray-600 hover:bg-gray-50'\n              }`}\n            >\n              {t === '7d' ? 'Last 7 Days' : t === '30d' ? 'Last 30 Days' : 'Last 90 Days'}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        {/* Stats Cards */}\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"p-3 bg-blue-50 rounded-lg\">\n              <Users className=\"w-6 h-6 text-blue-600\" />\n            </div>\n            <div className=\"text-sm text-green-600 flex items-center gap-1\">\n              <ArrowUp className=\"w-4 h-4\" />\n              10%\n            </div>\n          </div>\n          <span className=\"text-gray-600 text-sm\">Total Users</span>\n          <div className=\"text-2xl font-bold mt-1\">\n            {loading ? (\n              <div className=\"h-8 bg-gray-200 rounded animate-pulse w-24\" />\n            ) : (\n              stats.totalUsers.toLocaleString()\n            )}\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"p-3 bg-blue-50 rounded-lg\">\n              <Video className=\"w-6 h-6 text-blue-600\" />\n            </div>\n            <div className=\"text-sm text-green-600 flex items-center gap-1\">\n              <ArrowUp className=\"w-4 h-4\" />\n              15%\n            </div>\n          </div>\n          <span className=\"text-gray-600 text-sm\">Total Videos</span>\n          <div className=\"text-2xl font-bold mt-1\">\n            {loading ? (\n              <div className=\"h-8 bg-gray-200 rounded animate-pulse w-24\" />\n            ) : (\n              stats.totalVideos.toLocaleString()\n            )}\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"p-3 bg-blue-50 rounded-lg\">\n              <Clock className=\"w-6 h-6 text-blue-600\" />\n            </div>\n          </div>\n          <span className=\"text-gray-600 text-sm\">Avg. Processing Time</span>\n          <div className=\"text-2xl font-bold mt-1\">\n            {loading ? (\n              <div className=\"h-8 bg-gray-200 rounded animate-pulse w-24\" />\n            ) : (\n              formatDuration(stats.averageProcessingTime)\n            )}\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"p-3 bg-blue-50 rounded-lg\">\n              <Package className=\"w-6 h-6 text-blue-600\" />\n            </div>\n            <div className=\"text-sm text-green-600 flex items-center gap-1\">\n              <ArrowUp className=\"w-4 h-4\" />\n              20%\n            </div>\n          </div>\n          <span className=\"text-gray-600 text-sm\">Total Revenue</span>\n          <div className=\"text-2xl font-bold mt-1\">\n            {loading ? (\n              <div className=\"h-8 bg-gray-200 rounded animate-pulse w-24\" />\n            ) : (\n              formatMoney(stats.totalRevenue)\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Charts would go here */}\n      <div className=\"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">Video Generation Trends</h2>\n          <div className=\"h-[300px] flex items-center justify-center text-gray-500\">\n            Chart coming soon...\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">Revenue Growth</h2>\n          <div className=\"h-[300px] flex items-center justify-center text-gray-500\">\n            Chart coming soon...\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Analytics;"],"names":["Analytics","timeframe","setTimeframe","useState","loading","setLoading","stats","setStats","useEffect","fetchAnalytics","userCount","userError","supabase","videoCount","videoError","videos","processingError","avgTime","acc","video","start","end","transactions","revenueError","totalRevenue","tx","error","toast","formatDuration","ms","minutes","seconds","formatMoney","amount","jsxs","jsx","t","Users","ArrowUp","Video","Clock","Package"],"mappings":"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"}