import{s as o,j as e}from"./index-CZWYOJc5.js";import{r as c}from"./vendor-C93i42Td.js";import{k as i,y as L,s as S,S as z,n as q,I as B,j as I,z as P,p as K}from"./ui-DKXepuIc.js";const J=({type:n="content"})=>{const[h,E]=c.useState([]),[U,f]=c.useState(!0),[b,v]=c.useState(null),[a,t]=c.useState(null),[j,N]=c.useState(!1),[y,w]=c.useState(!1),k=c.useRef(null),_=c.useRef(null);c.useEffect(()=>{x()},[n]);const x=async()=>{try{f(!0),v(null);let s,r;switch(n){case"templates":({data:s,error:r}=await o.from("templates").select("*").order("created_at",{ascending:!1}));break;case"packages":({data:s,error:r}=await o.from("video_packages").select("*").order("created_at",{ascending:!1}));break;case"settings":({data:s,error:r}=await o.from("settings").select("*").order("key",{ascending:!0}));break;default:({data:s,error:r}=await o.from("content_sections").select("*, content_blocks(*)").order("created_at",{ascending:!0}))}if(r)throw r;E(s||[])}catch(s){console.error("Error fetching content:",s),v(s.message),i.error("Failed to load content")}finally{f(!1)}},F=async s=>{if(window.confirm("Are you sure you want to delete this item?"))try{const r=n==="packages"?"video_packages":n==="content"?"content_sections":n,{error:l}=await o.from(r).delete().eq("id",s);if(l)throw l;i.success("Item deleted successfully"),x()}catch(r){console.error("Error deleting item:",r),i.error("Failed to delete item")}},V=async s=>{if(s){if(!s.type.startsWith("image/")){i.error("Please select a valid image file");return}if(s.size>5*1024*1024){i.error("Image file must be less than 5MB");return}try{w(!0);const r=Date.now(),l=Math.random().toString(36).substring(7),d=s.name.split(".").pop(),u=`template-images/${r}-${l}.${d}`,{error:m}=await o.storage.from("images").upload(u,s,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:{publicUrl:g}}=o.storage.from("images").getPublicUrl(u);t(p=>({...p,image_url:g})),i.success("Image uploaded successfully")}catch(r){console.error("Error uploading image:",r),i.error("Failed to upload image")}finally{w(!1)}}},T=async s=>{if(s){if(!s.type.startsWith("video/")){i.error("Please select a valid video file");return}if(s.size>100*1024*1024){i.error("Video file must be less than 100MB");return}try{N(!0);const r=Date.now(),l=Math.random().toString(36).substring(7),d=s.name.split(".").pop(),u=`template-previews/${r}-${l}.${d}`,{error:m}=await o.storage.from("videos").upload(u,s,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:{publicUrl:g}}=o.storage.from("videos").getPublicUrl(u);t(p=>({...p,video_preview_url:g})),i.success("Video uploaded successfully")}catch(r){console.error("Error uploading video:",r),i.error("Failed to upload video")}finally{N(!1)}}},D=async s=>{try{const r=n==="packages"?"video_packages":n==="content"?"content_sections":n,{error:l}=await o.from(r).upsert(s);if(l)throw l;i.success("Changes saved successfully"),t(null),x()}catch(r){console.error("Error saving item:",r),i.error("Failed to save changes")}},R=(s,r,l)=>{const d=[...s];return d[r]=l,d},$=()=>{switch(n){case"templates":return e.jsx(B,{className:"w-8 h-8 text-blue-600"});case"packages":return e.jsx(q,{className:"w-8 h-8 text-blue-600"});case"settings":return e.jsx(z,{className:"w-8 h-8 text-blue-600"});default:return e.jsx(S,{className:"w-8 h-8 text-blue-600"})}},C=()=>{switch(n){case"templates":return"Video Templates";case"packages":return"Pricing Packages";case"settings":return"Site Settings";default:return"Content Management"}},M=()=>a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h2",{className:"text-xl font-bold",children:[a.id?"Edit":"Add New"," ",C().slice(0,-1)]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[n==="templates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name"}),e.jsx("input",{type:"text",value:a.title||"",onChange:s=>t({...a,title:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Template Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:s=>t({...a,description:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",rows:3,placeholder:"Template Description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Image"}),e.jsxs("div",{className:"space-y-2",children:[a.image_url&&e.jsx("div",{className:"relative aspect-video w-full max-w-md",children:e.jsx("img",{src:a.image_url,alt:"Template Preview",className:"w-full h-full object-cover rounded-lg"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var s;return(s=_.current)==null?void 0:s.click()},disabled:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),y?"Uploading...":"Upload Image"]}),e.jsx("input",{ref:_,type:"file",accept:"image/*",onChange:s=>{var r;return V((r=s.target.files)==null?void 0:r[0])},className:"hidden"}),a.image_url&&e.jsx("button",{type:"button",onClick:()=>t({...a,image_url:""}),className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Remove Image"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preview Video"}),e.jsxs("div",{className:"space-y-2",children:[a.video_preview_url&&e.jsx("div",{className:"relative aspect-video w-full max-w-md",children:e.jsx("video",{src:a.video_preview_url,className:"w-full h-full rounded-lg",controls:!0,preload:"metadata",children:"Your browser does not support the video tag."})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>{var s;return(s=k.current)==null?void 0:s.click()},disabled:j,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),j?"Uploading...":"Upload Video"]}),e.jsx("input",{ref:k,type:"file",accept:"video/*",onChange:s=>{var r;return T((r=s.target.files)==null?void 0:r[0])},className:"hidden"}),a.video_preview_url&&e.jsx("button",{type:"button",onClick:()=>t({...a,video_preview_url:""}),className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Remove Video"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prompt"}),e.jsx("textarea",{value:a.prompt||"",onChange:s=>t({...a,prompt:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",rows:4,placeholder:"Template generation prompt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Orientation"}),e.jsxs("select",{value:a.orientation||"landscape",onChange:s=>t({...a,orientation:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"landscape",children:"Landscape (16:9)"}),e.jsx("option",{value:"portrait",children:"Portrait (9:16)"})]})]})]}),n==="packages"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Package Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>t({...a,name:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:s=>t({...a,description:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credits"}),e.jsx("input",{type:"number",value:a.credits||"",onChange:s=>t({...a,credits:parseInt(s.target.value)}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Validity (Days)"}),e.jsx("input",{type:"number",value:a.validity_days||"",onChange:s=>t({...a,validity_days:parseInt(s.target.value)}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (USD)"}),e.jsx("input",{type:"number",value:a.price||"",onChange:s=>t({...a,price:parseFloat(s.target.value)}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (ILS)"}),e.jsx("input",{type:"number",value:a.price_ils||"",onChange:s=>t({...a,price_ils:parseFloat(s.target.value)}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Features"}),e.jsxs("div",{className:"space-y-2",children:[(a.features||[]).map((s,r)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s,onChange:l=>t({...a,features:R(a.features,r,l.target.value)}),className:"flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}),e.jsx("button",{onClick:()=>t({...a,features:a.features.filter((l,d)=>d!==r)}),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(P,{className:"w-5 h-5"})})]},r)),e.jsx("button",{onClick:()=>t({...a,features:[...a.features||[],""]}),className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-500 hover:text-blue-500 transition-colors",children:"Add Feature"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Resolution"}),e.jsxs("select",{value:a.max_resolution||"1080p",onChange:s=>t({...a,max_resolution:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"720p",children:"720p"}),e.jsx("option",{value:"1080p",children:"1080p"}),e.jsx("option",{value:"4K",children:"4K"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Support Level"}),e.jsxs("select",{value:a.support_level||"standard",onChange:s=>t({...a,support_level:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"priority",children:"Priority"}),e.jsx("option",{value:"24/7",children:"24/7"})]})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>t(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:()=>D(a),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Save Changes"})]})]})}):null,A=()=>U?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]},s))}):b?e.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("p",{children:b})]}):h.length===0?e.jsx("div",{className:"text-center text-gray-500 py-12",children:"No content found"}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:h.map(s=>e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:s.title||s.name||s.key}),e.jsx("p",{className:"text-gray-600",children:s.description||s.subtitle||JSON.stringify(s.value)}),n==="templates"&&s.prompt&&e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-gray-500",children:"Prompt:"}),e.jsx("p",{className:"mt-1 text-gray-600",children:s.prompt})]}),n==="templates"&&e.jsxs("div",{className:"mt-4 space-y-4",children:[s.image_url&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Preview Image:"}),e.jsx("div",{className:"mt-2 relative aspect-video w-full max-w-md",children:e.jsx("img",{src:s.image_url,alt:"Template Preview",className:"w-full h-full object-cover rounded-lg"})})]}),s.video_preview_url&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Preview Video:"}),e.jsx("div",{className:"mt-2 relative aspect-video w-full max-w-md",children:e.jsx("video",{src:s.video_preview_url,className:"w-full h-full rounded-lg",controls:!0,preload:"metadata",children:"Your browser does not support the video tag."})})]})]}),n==="packages"&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Credits:"}),e.jsx("span",{className:"font-medium",children:s.credits})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"USD:"}),e.jsxs("span",{className:"font-medium",children:["$",s.price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"ILS:"}),e.jsxs("span",{className:"font-medium",children:["₪",s.price_ils]})]})]}),s.features&&e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-gray-500",children:"Features:"}),e.jsx("ul",{className:"mt-2 space-y-1",children:s.features.map((r,l)=>e.jsxs("li",{className:"text-gray-600",children:["• ",r]},l))})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded",onClick:()=>t(s),children:e.jsx(S,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-red-600 hover:bg-red-50 rounded",onClick:()=>F(s.id),children:e.jsx(P,{className:"w-5 h-5"})})]})]})},s.id))});return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[$(),e.jsx("h1",{className:"text-3xl font-bold",children:C()})]}),e.jsxs("button",{onClick:()=>t({}),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Add New"]})]}),A(),M()]})};export{J as default};
//# sourceMappingURL=ContentEditor-B_TEqlCK.js.map
